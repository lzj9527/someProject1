<!doctype html>
<html>

<head>
    <title>列表</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,maximum-scale=1.0,minimum-scale=1.0, initial-scale=1.0 user-scalable=no">
    <meta name="format-detection" content="telephone=no" />
    <!-- bootstrap start -->
    <link rel="stylesheet" href="../static/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/css/bootstrap-theme.min.css">
    <script src="../static/js/jquery-3.0.0.js"></script>
    <script src="../static/js/jquery.lazyload.js"></script>
    <script type="text/javascript" src="../static/js/androidJSInterface.js"></script>
    <script src="../static/js/bootstrap.min.js"></script>
    <!-- bootstrap end -->
    <script src="../static/js/touch.js"></script>
    <script src="../static/js/config.js"></script>
    <script src="../static/js/function.js"></script>
    <link rel="stylesheet" type="text/css" href="../static/css/ui-box.css">
    <link rel="stylesheet" type="text/css" href="../static/css/ui-base.css">
    <link rel="stylesheet" type="text/css" href="../static/css/ui-color.css">
    <link rel="stylesheet" type="text/css" href="../static/css/ui-control.css">
    <link rel="stylesheet" type="text/css" href="../static/css/ui-icon.css">
    <link rel="stylesheet" type="text/css" href="../static/css/ui-my.css">




</head>

<body class="um-vp" ontouchstart>
    <div id="page_1" class="up ub" tabindex="0">
        <div class="ub ub-fh">
            <!-- <div id="menu" class="ub sc-bg" style="width: 7em;">
                        <div id="btlist" class="ub ub-ver uinn-t">
                            <div class="ub   bc-bg ub-ac ub-pc " style="height: 5em; width: 5em;  border-radius: 50%; margin:1em">头像</div>
                            <div id="btCategory" class="ub  umar-t umar-b ub-ac ub-pc sc-btn" style="height: 7em; width: 7em;">分 类</div>
                            <div id="btCat" class="ub  umar-t umar-b ub-ac ub-pc " style="height: 7em; width: 7em;">购物车</div>
                            <div id="btSearch" class="ub  umar-t umar-b ub-ac ub-pc " style="height: 7em; width: 7em;">搜 索</div>
                        </div>
                    </div> -->
            <div id="content" class="ub ub-f1">
                <div class="ub ub-f1 ub-ver " id="list_box">
                    <div class="ub ub-ac" id="list_header" style="height:4em">

                        <div class="ub  ub-f1 ufr ub-pe">
                            <!-- <div class="ub">
                                                <input name="keyword" type="text" placeholder="搜索" class="ub-search-input-my keywords">
                                            </div>
                                            <div class="ub umar-r1 ">
                                                <div class="ub ub-img icon-search-my submit " style="padding-left:2em;padding-right:2em" id="btnProSearch"></div>
                                            </div> 
                                             <div class="ub umar-r1">
                                                <div class="ub ub-img umar-r icon-list" id="btnList"></div>
                                            </div>
                                            <div class="ub umar-r1">
                                                <div class="ub ub-img icon-block-act" id="btnBlock"></div>
                                            </div>
                                           -->
                        </div>
                    </div>
                    <div class="ub ub-f1" id="list_body">
                        <div class="container ub-f1" id="htmlBox">

                            <!--
                                <div class="col-md-3 col-sm-6 plist  ">
                                    <div class="ub-img ub-p-new"></div>
                                    <div class="ub ub-img pimg " style="background-image: url(../static/images/eg.png)"></div>
                                    <div class="ub ub-ver">
                                        <div class="ub ub-pc umar-t">18K白金钻石女戒</div>
                                        <div class="ub ub-pc" style="color: #ccc">共4件</div>
                                    </div>
                                </div>
                               -->

                        </div>
                    </div>
                </div>

                <!--               <div class="ub sc-bg ub-ver uinn5" style="width: 0em; height: 0; overflow: hidden; display:none;">
                    <div class="ub ub-ver" style="margin: 0em 0em">
                        <div class="ub uba umar-a uinn sc-border ub-pc bold" id="catename"></div>
                        
                        <div class="ub umar-l uinn  umar-t" style="color: #be9d6a; margin-top: 2em;">筛选条件</div>
                        
                        <div class="container-fluid">
                            <div class="col-sm-6 umar-b none-padding none-padding">
                                <div class="uinl uinn3 umw4 sc-bg-active sc-text-active">不限</div>
                            </div>
                            <div class="col-sm-6 umar-b none-padding">
                                <div class="uinl uinn3 umw4">简单款</div>
                            </div>
                            <div class="col-sm-6 umar-b none-padding">
                                <div class="uinl uinn3 umw4">豪华款</div>
                            </div>
                        </div>

                        <div class="ub  umh1 ub-img4" style="background-image: url(../static/images/1_line-34.png)"></div>
                        <div class="ub umar-l uinn umar-b " style="font-weight: bold;">钻石分数</div>
                        <div class="container-fluid">
                            <div class="col-sm-6 umar-b none-padding">
                                <div class="uinl uinn3 umw4 weight_f bc-text-b1" data-values="0" >不限</div>
                            </div>
                            <div class="col-sm-6 umar-b none-padding">
                                <div class="uinl uinn3 umw4 weight_f bc-text-c2" data-values="0-0.19">0.19 以下</div>
                            </div>
                            <div class="col-sm-6 umar-b none-padding">
                                <div class="uinl uinn3 umw4 weight_f bc-text-c2" data-values="0.2-0.29">0.2-0.29</div>
                            </div>
                            <div class="col-sm-6 umar-b none-padding">
                                <div class="uinl uinn3 umw4 weight_f bc-text-c2" data-values="0.3-0.39">0.3-0.39</div>
                            </div>
                            <div class="col-sm-6 umar-b none-padding">
                                <div class="uinl uinn3 umw4 weight_f bc-text-c2" data-values="0.4-0.49">0.4-0.49</div>
                            </div>
                            <div class="col-sm-6 umar-b none-padding">
                                <div class="uinl uinn3 umw4 weight_f bc-text-c2" data-values="0.5">0.5 以上</div>
                            </div>
                        </div>
                        <div class="ub umar-a umh1 ub-img4" style="background-image: url(../static/images/1_line-34.png)"></div>
                        <div class="ub umar-l uinn umar-b"  style="font-weight: bold;">价格</div>
                        <div class="container-fluid">
                            <div class="col-sm-6 umar-b none-padding">
                                <div class="uinl uinn3 umw4 price  bc-text-b1" data-values="0">不限</div>
                            </div>
                            <div class="col-sm-6 umar-b none-padding">
                                <div class="uinl uinn3 umw4 price bc-text-c2" data-values="0-2500">2500 以下</div>
                            </div>
                            <div class="col-sm-6 umar-b none-padding">
                                <div class="uinl uinn3 umw4 price bc-text-c2" data-values="2500-5000">2500-5000</div>
                            </div>
                            <div class="col-sm-6 umar-b none-padding">
                                <div class="uinl uinn3 umw4 price bc-text-c2" data-values="5000-8000">5000-8000</div>
                            </div>
                            <div class="col-sm-6 umar-b none-padding">
                                <div class="uinl uinn3 umw4 price bc-text-c2" data-values="8000-12000">8000-12000</div>                                
                            </div>
                            <div class="col-sm-6 umar-b none-padding">
                                <div class="uinl uinn3 umw4 price bc-text-c2" data-values="12000">12000 以上</div>
                            </div>
                        </div>
                        <div class="ub umar-a umh1 ub-img4" style="background-image: url(../static/images/1_line-34.png)"></div>
                        
                        <div>
                            <div class="container-fluid">
                                <div class="col-sm-6 umar-b umar-t none-padding">
                                    <div class="ub umar-r uc-a1 uba uinn3 sc-border2 ub-pc">18K金</div>
                                </div>
                                <div class="col-sm-6 umar-b umar-t none-padding">
                                    <div class="ub umar-r uc-a1 uba uinn3 sc-border2 ub-pc">18K金</div>
                                </div>
                                <div class="col-sm-6 umar-b umar-t none-padding">
                                    <div class="ub umar-r uc-a1 uba uinn3 sc-border2 ub-pc">18K金</div>
                                </div>
                                <div class="col-sm-6 umar-b umar-t none-padding">
                                    <div class="ub umar-r uc-a1 uba uinn3 sc-border2 ub-pc">18K金</div>
                                </div>
                            </div>
                        </div>
                        -->
            </div>
        </div>

    </div>
    </div>
    </div>
</body>
<script>
    var weight_f = "0";
    var price = "0";

    var keyword = '';
    var strdiamond = '';

    var storage = window.localStorage;

    if (getUrlParam("keywords") != '' && (isDefine(getUrlParam("keywords")))) {
        keywords = '&keyword=' + getUrlParam("keywords");
    } else {
        keywords = '';
    }
    console.log(keywords);

    if (storage["strdiamond"] != '' && (isDefine(storage["strdiamond"]))) {
        strdiamond = storage["strdiamond"];
    } else {
        strdiamond = '';
    }

    var ccate = '';
    ccate = getUrlParam("ccate");
    if (ccate != '' && isDefine(ccate)) {
        ccate = '&ccate=' + ccate;
    } else {
        ccate = '';
    }

    var catename = '';
    catename = unescape(getUrlParam("catename"));
    strcatename = escape(getUrlParam("catename"));
    //console.log(strcatename);
    $("#catename").html(catename);

    $(function () {

        touch.on('#btnProSearch', 'touchstart  touchmove', function (ev) {
            $("#btnProSearch").removeClass("icon-search-my");
            $("#btnProSearch").addClass("icon-search-act-my");
            var keywords = encodeURI(encodeURI($('.keywords').val()));
            //storage["keywords"]=$('.keywords').val();
            //console.log(keywords);
            openWindow(6, '产品列表',
                'http://www.zsmtvip.com/addons/ewei_shop/template/pad/default/shop/list.html?keywords=' +
                keywords + '&catename=搜索');
        });

        touch.on('#btnProSearch', 'touchend', function (ev) {
            $("#btnProSearch").removeClass("icon-search-act-my");
            $("#btnProSearch").addClass("icon-search-my");


        });

        touch.on('#btnBlock', 'touchstart  touchmove', function (ev) {
            $("#btnBlock").removeClass("icon-block");
            $("#btnBlock").addClass("icon-block-act");
            //console.log('http://www.zsmtvip.com/addons/ewei_shop/template/pad/default/shop/list.html?ccate='+getUrlParam("ccate")+'&catename='+strcatename);
        });


        touch.on('#btnBlock', 'touchend', function (ev) {
            $("#btnBlock").removeClass("icon-block-act");
            $("#btnBlock").addClass("icon-block");

            openWindow(6, '产品列表',
                'http://www.zsmtvip.com/addons/ewei_shop/template/pad/default/shop/list.html?ccate=' +
                getUrlParam("ccate") + '&catename=' + strcatename);
        });


        touch.on('#btnList', 'touchstart  touchmove', function (ev) {
            $("#btnList").removeClass("icon-list");
            $("#btnList").addClass("icon-list-act");
            //console.log('http://www.zsmtvip.com/addons/ewei_shop/template/pad/default/shop/list-ani.html?ccate='+getUrlParam("ccate")+'&catename='+strcatename);
        });

        touch.on('#btnList', 'touchend', function (ev) {
            $("#btnList").removeClass("icon-list-act");
            $("#btnList").addClass("icon-list");

            openWindow(7, '产品列表',
                'http://www.zsmtvip.com/addons/ewei_shop/template/pad/default/shop/list-ani.html?ccate=' +
                getUrlParam("ccate") + '&catename=' + strcatename);
        });


        touch.on('.weight_f', 'tap', function (ev) {

            $('.weight_f').removeClass('bc-text-b1');

            $(this).removeClass('bc-text-c2');
            $(this).addClass('bc-text-b1');



            weight_f = $(this).data("values");
            if (weight_f == "0") {
                if (price == "0") {
                    date_ajax(
                        'http://www.zsmtvip.com/app/index.php?i=2&c=entry&do=goods_list&psize=9999' +
                        keywords + '&m=test' + ccate + '');
                } else {
                    date_ajax(
                        'http://www.zsmtvip.com/app/index.php?i=2&c=entry&do=goods_list&psize=9999' +
                        keywords + '&m=test' + ccate + '&price=' + price);
                }
            } else {
                if (price == "0") {
                    date_ajax(
                        'http://www.zsmtvip.com/app/index.php?i=2&c=entry&do=goods_list&psize=9999' +
                        keywords + '&m=test' + ccate + '&weight_f=' + weight_f);
                } else {
                    date_ajax(
                        'http://www.zsmtvip.com/app/index.php?i=2&c=entry&do=goods_list&psize=9999' +
                        keywords + '&m=test' + ccate + '&weight_f=' + weight_f + '&price=' + price);
                }
            }
        });



        touch.on('.price', 'tap', function (ev) {

            $('.price').removeClass('bc-text-b1');

            $(this).removeClass('bc-text-c2');
            $(this).addClass('bc-text-b1');

            price = $(this).data("values");
            if (weight_f == "0") {
                if (price == "0") {
                    date_ajax(
                        'http://www.zsmtvip.com/app/index.php?i=2&c=entry&do=goods_list&psize=9999' +
                        keywords + '&m=test' + ccate + '');
                } else {
                    date_ajax(
                        'http://www.zsmtvip.com/app/index.php?i=2&c=entry&do=goods_list&psize=9999' +
                        keywords + '&m=test' + ccate + '&price=' + price);
                }
            } else {
                if (price == "0") {
                    date_ajax(
                        'http://www.zsmtvip.com/app/index.php?i=2&c=entry&do=goods_list&psize=9999' +
                        keywords + '&m=test' + ccate + '&weight_f=' + weight_f);
                } else {
                    date_ajax(
                        'http://www.zsmtvip.com/app/index.php?i=2&c=entry&do=goods_list&psize=9999' +
                        keywords + '&m=test' + ccate + '&weight_f=' + weight_f + '&price=' + price);
                }
            }
        });


        //var init_url='http://www.zsmtvip.com/app/index.php?i=2&c=entry&do=goods_list&psize=9999'+keywords+'&m=test'+ccate+'';

        // if (keywords!=''){

        var init_url = 'http://www.zsmtvip.com/app/index.php?i=2&c=entry&do=searchList&m=test' + keywords + '';

        // }

        $.ajax({
            url: init_url,
            type: "get",
            dataType: 'jsonp',
            success: function (data) {
                console.log(data);
                //console.log('http://www.zsmtvip.com/app/index.php?i=2&c=entry&do=goods_list&psize=9999'+keywords+'&m=test'+ccate+'');
                if (data.resultCode == "0") {
                    show_list(data);

                } else {
                    showToast(data.error);
                }
            },
            error: function () {
                //showToast("error!");
            }
        })


    });

    function product_onclick() {
        //console.log('here');
        touch.on('.btnProduct', 'tap', function (ev) {

            //if (strdiamond==''){
            //  openDetailWindow(id,'');
            //}else{
            //var storage = window.localStorage;  
            //if (storage["GIA_page_from"]=='2'){
            //}else{                
            //}
            //window.android.openDetailWindowFromJIA(id,'',strdiamond);

            // }


            var tag = $(this).data("tag");
            var isshop = $(this).data("isnodiscount");
            var id = $(this).data('values');

            if (isshop != '1') {
                isshop = '0';
            }

//            console.log(id);
//            console.log(tag);
//            console.log(isshop);

            if (tag == 'one') {
                openDetailWindow(id, '', isshop);
            } else {
                openDetailWindowInCoupleRing(id, '', isshop);
            }
        });

        $("div.lazy").lazyload({
            effect: "fadeIn"
        });

    }

    function show_list(data) {
        ////console.log(JSON.stringify(data));
        var strHtml = "";
        //console.log(data.datas.list.length);
        if (isDefine(data.datas.list)) {
            for (var i = 0; i < data.datas.list.length; i++) {
                //if (data.datas.list[i].isnodiscount=='0'){
                ////console.log(data.datas.list[i].title);
                //}

                strHtml += '<div class="ub ub-ver col-md-3 col-sm-3 plist  ">';
                //strHtml+='                                <div class="ub-img ub-p-new"></div>';
                strHtml +=
                    '<div class="ub ub-img5  plistimg0902 btnProduct  lazy" data-isnodiscount="' +
                    data.datas.list[i].isnodiscount + '"  data-tag="' + data.datas.list[i].tag + '" data-values="' +
                    data.datas.list[i].id + '"   data-original="' + data.datas.list[i].thumb.url +
                    '"    style="background-image: url(../static/images/grey.gif)"></div>';
                strHtml += '<div class="ub ub-ver">';
                strHtml +=
                    '<div class="ub ub-pc umar-t bc-text-c2 "  style="line-height:1.5em;height:3em; margin-bottom:1.5em; overflow:hidden;font-size:18px;">' +
                    data.datas.list[i].title + '</div>';
                //if (data.datas.list[i].count>0){
                //    strHtml+='                                    <div class="ub ub-pc bc-text-e1">共'+data.datas.list[i].count+'件</div>';
                // }
                strHtml += '</div>';
                strHtml += '</div>';
            }
            ////console.log(strHtml);
            $("#htmlBox").html(strHtml);
        } else {
            $("#htmlBox").html('<div align="center">没有找到相关商品</div>');
        }

        product_onclick();
    }


    function date_ajax(url) {
        //console.log (url);
        $.ajax({
            url: url,
            type: "get",
            dataType: 'jsonp',
            success: function (data) {
                if (data.resultCode == "0") {
                    show_list(data);
                } else {
                    showToast(data.error);
                }
            },
            error: function () {
                //showToast("error!");
            }
        })
    }
</script>

</html>